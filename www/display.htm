<html>
<head>
<title> MQTT Websocket Test</title>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
<script>

function sub_mqtt_msg() {
// Send an MQTT message
  var mqtt_server = document.getElementById("mqtt_server").value;
  var mqtt_port = Number(document.getElementById("mqtt_port").value);

  client = new Paho.MQTT.Client(mqtt_server, mqtt_port,"");
  client.onMessageArrived = onMessageArrived;
  client.onMessageArrived = onMessageArrived;
  client.connect({onSuccess:onConnect});
  document.getElementById("submsg").innerHTML = "Trying to connect...";

}
function onConnect() {
  document.getElementById("submsg").innerHTML = "New connection made...";
  var mqtt_destname = document.getElementById("mqtt_destname").value;  
  client.subscribe(mqtt_destname);
  document.getElementById("submsg").innerHTML = "Subscribing to topic: " + mqtt_destname + " ...";
}
function onMessageArrived(message) {
  var result = message.destinationName + " : " + message.payloadString + "";
  document.getElementById("submsg").innerHTML = result;
}

</script>
<body onload="sub_mqtt_msg()">
<h1>MQTT Websocket Test Page</h1>

Server Name: <input type="text" id="mqtt_server" value="clumsy.lan"><br><br>
Websocket: <input type="text" id="mqtt_port" value="8185"><br><br>
DestinationName: <input type="text" id="mqtt_destname" value="temp"><br><br>

<button onclick="sub_mqtt_msg()">Subscript to MQTT</button>
<hr>
<h2>Subscribed Messages:</h2>
<div id=submsg></div>
</body>

</html>
